# remove all R objects in the working directory
rm(list=ls(all=TRUE))
#Increase memory size (java out of memory and must be before pkg load)
options(java.parameters = "-Xmx15000m")
# id packages
packages <- c("plyr","dplyr","readxl", "zoo",  "stringi", "ggplot2","tidyr","stringr")
#install and library
lapply(packages, require, character.only = TRUE)
#set folders
proj_name = "IAVA Scorecard"
base_path="C:/Users/Stephen.M.Trask/Documents"
severity_data="S:/CISO/ACAS/ACAS IAVA Reports/IAVA Severity Summary Reports CSV Format"
summary_data="S:/CISO/ACAS/ACAS IAVA Reports/IAVA Summary Reports CSV Format"
archive_data="S:/CISO/ACAS/ACAS IAVA Reports/IAVA SCORECARD ARCHIVE DATA"
report="S:/CISO/ACAS/ACAS IAVA Reports"
code.plc='H:/Code Source/IAVA_Aggregation_Reporting'
load(file.path(code.plc,"IAVA_WORKSPACE.RData"))
############################################# REMOVE DATA
dir.create(file.path(severity_data, sev.max.date), showWarnings = FALSE, recursive = FALSE, mode = "0777")
dir.create(file.path(summary_data, sum.max.date), showWarnings = FALSE, recursive = FALSE, mode = "0777")
newsumfldr=file.path(summary_data, sum.max.date)
for (i in summary.files){
file.copy(file.path(summary_data,i), file.path(newsumfldr, i),overwrite = T,copy.mode = TRUE, copy.date = TRUE)
file.remove(file.path(summary_data,i))
}
newsevfldr=file.path(severity_data, sev.max.date)
for (i in severity.files){
file.copy(file.path(severity_data,i), file.path(newsevfldr, i),overwrite = T,copy.mode = TRUE, copy.date = TRUE)
file.remove(file.path(severity_data,i))
}
##########################   Send Mail Option   #########################################
library(mailR)
# d <- weekdays(as.Date(date))
recipients <- c("victor.f.sorano.mil@mail.mil", "janice.a.stewart2.civ@mail.mil", "kenneth.d.stamm.ctr@mail.mil", "charles.m.grimm.civ@mail.mil")
cc_list <- c("stephen.m.trask.ctr@mail.mil", "adrian.l.farquhar.ctr@mail.mil")
sub=paste("IAVA Briefing, dated ", sum.max.date, sep="")
body=paste("A new IAVA Briefing has been created, dated ", sum.max.date, " The file is located on the SP 2010 Site.  https://rhca.amedd.army.mil/department/BI/Pages/Cyber-Security-Projects.aspx ",sep = "")
send.mail(from = "IAVA Update <strask@tiag.net>",
to = recipients,
cc = cc_list,
subject = sub,
body = body,
smtp = list(host.name = "smtp.gmail.com", port = 25, user.name = "strask@tiag.net", passwd = "st2583990", ssl = TRUE),
authenticate = TRUE,
send = TRUE,
#attach.files = c(filename),
# file.names = c(filename), # optional parameter
# file.descriptions = c("Current IAVA Status"), # optional parameter
debug = TRUE)
# remove all R objects in the working directory
rm(list=ls(all=TRUE))
#Increase memory size (java out of memory and must be before pkg load)
options(java.parameters = "-Xmx15000m")
# id packages
packages <- c("plyr","dplyr","readxl", "zoo",  "stringi", "ggplot2","tidyr","stringr")
#install and library
lapply(packages, require, character.only = TRUE)
#set folders
proj_name = "IAVA Scorecard"
base_path="C:/Users/Stephen.M.Trask/Documents"
severity_data="S:/CISO/ACAS/ACAS IAVA Reports/IAVA Severity Summary Reports CSV Format"
summary_data="S:/CISO/ACAS/ACAS IAVA Reports/IAVA Summary Reports CSV Format"
archive_data="S:/CISO/ACAS/ACAS IAVA Reports/IAVA SCORECARD ARCHIVE DATA"
report="S:/CISO/ACAS/ACAS IAVA Reports"
code.plc='H:/Code Source/IAVA_Aggregation_Reporting'
#set project path
proj_path = paste(base_path,"/",proj_name,sep = "")
out_path = file.path(proj_path, "Output")
cleaned_path = file.path(proj_path, "CleanData")
data_path = file.path(proj_path, "RawData")
Outlier_Path  = file.path(proj_path, "Outliers")
Asset_path="S:/CISO/ACAS/ACAS IAVA Reports/Current Asset Numbers/Total Assets by HRP.xlsx"
load(file.path(report,"IAVA_WORKSPACE.RData"))
